<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firms Directory - Claim Cipher</title>
    
    <!-- All Page Styles -->
    <link rel="stylesheet" href="styles/pages.css">
</head>
<body class="master-interface" data-page="firms">
    <header class="cipher-header">
        <div class="header-content">
            <div class="app-brand">
                <span class="logo">🎤</span>
                <span>Claim Cipher</span>
                <span class="version-tag">Professional Suite</span>
            </div>
            
            <!-- Master Tab Navigation -->
            <nav class="master-tabs">
                <a href="dashboard.html" class="tab-btn" data-page="dashboard">
                    <span class="tab-icon">🏠</span>
                    <span class="tab-label">Dashboard</span>
                </a>
                <!-- Claims Workflow Order: Route → Mileage → Jobs → Complete -->
                <a href="route-optimizer.html" class="tab-btn" data-page="route-optimizer">
                    <span class="tab-icon">🗺️</span>
                    <span class="tab-label">Routes</span>
                </a>
                <a href="mileage-calculator.html" class="tab-btn" data-page="mileage-calculator">
                    <span class="tab-icon">🧮</span>
                    <span class="tab-label">Mileage</span>
                </a>
                <a href="jobs.html" class="tab-btn" data-page="jobs">
                    <span class="tab-icon">💼</span>
                    <span class="tab-label">Jobs</span>
                </a>
                <a href="calendar.html" class="tab-btn" data-page="calendar">
                    <span class="tab-icon">📅</span>
                    <span class="tab-label">Calendar</span>
                </a>
                <a href="total-loss.html" class="tab-btn" data-page="total-loss">
                    <span class="tab-icon">📋</span>
                    <span class="tab-label">Total Loss</span>
                </a>
                <!-- Supporting Tools -->
                <a href="analytics.html" class="tab-btn" data-page="analytics">
                    <span class="tab-icon">📊</span>
                    <span class="tab-label">Analytics</span>
                </a>
                <a href="firms.html" class="tab-btn active" data-page="firms">
                    <span class="tab-icon">🏢</span>
                    <span class="tab-label">Firms</span>
                </a>
                <a href="help.html" class="tab-btn" data-page="help">
                    <span class="tab-icon">📚</span>
                    <span class="tab-label">Help</span>
                </a>
            </nav>
            
            <div class="user-section">
                <div class="user-info">
                    <div class="user-name" id="userName">Professional User</div>
                    <div class="user-role">Claims Specialist</div>
                </div>
                <button class="logout-btn cipher-btn cipher-btn--danger" onclick="handleLogout()">Logout</button>
            </div>
        </div>
    </header>

    <!-- Firms Directory Content -->
    <main class="master-content">
        <div class="tab-header">
            <h1>🏢 Firms Directory</h1>
            <p>Manage billing firms, rates, and professional network</p>
            <div class="tab-actions">
                <button class="cipher-btn cipher-btn--primary" id="addBillingFirmBtn">
                    💰 Add Billing Firm
                </button>
                <button class="cipher-btn cipher-btn--secondary" id="exportDirectoryBtn">
                    📤 Export Directory
                </button>
            </div>
        </div>
        
        <div class="firms-directory-container">
            <div class="directory-sections">
                <!-- Add New Firm Section -->
                <div class="section add-new-firm">
                    <h3>➕ Add New Firm</h3>
                    <p>Add firms to your billing directory with rates and payment details</p>
                    
                    <!-- Firm Details Form -->
                    <div class="add-firm-form cipher-glass">
                        <div class="form-section">
                            <h4>Firm Information</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="firmName">Firm Name *</label>
                                    <input type="text" id="firmName" placeholder="e.g., Crawford & Company" required>
                                </div>
                                <div class="form-group">
                                    <label for="firmType">Firm Type</label>
                                    <select id="firmType">
                                        <option value="">Select Type</option>
                                        <option value="carrier">Insurance Carrier</option>
                                        <option value="tpa">Third Party Administrator</option>
                                        <option value="adjuster">Independent Adjuster</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="contactEmail">Contact Email</label>
                                    <input type="email" id="contactEmail" placeholder="claims@firm.com">
                                </div>
                                <div class="form-group">
                                    <label for="contactPhone">Contact Phone</label>
                                    <input type="tel" id="contactPhone" placeholder="(555) 123-4567">
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h4>Rate Configuration</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="dailyRate">Daily Auto Rate</label>
                                    <input type="number" id="dailyRate" placeholder="450.00" step="0.01">
                                </div>
                                <div class="form-group">
                                    <label for="catRate">Catastrophic Rate</label>
                                    <input type="number" id="catRate" placeholder="600.00" step="0.01">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="heavyRate">Heavy Claims Rate</label>
                                    <input type="number" id="heavyRate" placeholder="750.00" step="0.01">
                                </div>
                                <div class="form-group">
                                    <label for="mileageRate">Mileage Rate (per mile)</label>
                                    <input type="number" id="mileageRate" placeholder="0.67" step="0.01">
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h4>Payment Details</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="paymentSchedule">Payment Schedule</label>
                                    <select id="paymentSchedule">
                                        <option value="">Select Schedule</option>
                                        <option value="weekly">Weekly</option>
                                        <option value="bi-weekly">Bi-weekly</option>
                                        <option value="monthly">Monthly</option>
                                        <option value="net-30">Net 30</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="paymentMethod">Payment Method</label>
                                    <select id="paymentMethod">
                                        <option value="">Select Method</option>
                                        <option value="ach">ACH Transfer</option>
                                        <option value="check">Check</option>
                                        <option value="wire">Wire Transfer</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="cipher-btn cipher-btn--secondary" id="clearFormBtn">Clear</button>
                            <button type="button" class="cipher-btn cipher-btn--primary" id="saveFirmBtn">💾 Save to Directory</button>
                        </div>
                    </div>
                </div>
                
                <!-- Your Billing Firms Directory -->
                <div class="section billing-firms-directory">
                    <h3>💰 Your Billing Firms Directory</h3>
                    <p>Saved firms with configured rates and payment details</p>
                    
                    <!-- Search Bar -->
                    <div class="directory-controls">
                        <div class="search-bar">
                            <input type="text" id="billingFirmSearch" placeholder="🔍 Search your billing firms...">
                        </div>
                        <div class="filter-controls">
                            <select id="paymentScheduleFilter">
                                <option value="">All Payment Schedules</option>
                                <option value="weekly">Weekly</option>
                                <option value="bi-weekly">Bi-weekly</option>
                                <option value="monthly">Monthly</option>
                                <option value="net-30">Net 30</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Billing Firms Directory Table -->
                    <div class="firms-table-container" id="billingFirmsContainer">
                        <div class="empty-directory">
                            <div class="empty-icon">🏢</div>
                            <h4>No firms added yet</h4>
                            <p>Use the form above to add your first billing firm</p>
                        </div>
                    </div>
                </div>
                
                <!-- Featured Firm Directory -->
                <div class="section hiring-firms">
                    <h3>🎯 Featured Firm Directory</h3>
                    <p>90-100% of independent appraiser hiring for auto claims</p>
                    
                    <!-- Search and Filter Bar -->
                    <div class="directory-controls">
                        <div class="search-bar">
                            <input type="text" id="firmSearch" placeholder="🔍 Search firms, locations, or services...">
                        </div>
                        <div class="filter-controls">
                            <select id="coverageFilter">
                                <option value="">All Coverage Areas</option>
                                <option value="nationwide">Nationwide</option>
                                <option value="regional">Regional</option>
                            </select>
                            <select id="serviceFilter">
                                <option value="">All Services</option>
                                <option value="daily-auto">Daily Auto</option>
                                <option value="catastrophic">Catastrophic</option>
                                <option value="heavy">Heavy Claims</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Category Tabs -->
                    <div class="directory-tabs">
                        <button class="directory-tab-btn active" data-category="nationwide-daily">
                            <span class="tab-count">22</span>
                            Nationwide Daily Auto
                        </button>
                        <button class="directory-tab-btn" data-category="catastrophic">
                            <span class="tab-count">15</span>
                            Catastrophic Claims
                        </button>
                        <button class="directory-tab-btn" data-category="regional">
                            <span class="tab-count">18</span>
                            Regional Specialists
                        </button>
                    </div>
                    
                    <!-- Firms Table -->
                    <div class="firms-table-container" id="firmsTableContainer">
                        <!-- Content populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="config/dev-config.js"></script>
    <script src="config/supabase-config.js"></script>
    
    <!-- Color Scheme Manager -->
    <script src="scripts/shared/color-scheme-manager.js"></script>
    
    <!-- Core Services -->
    <script src="scripts/auth-service.js"></script>
    <script src="scripts/billing-system/job-billing-service.js"></script>
    
    <!-- Firms Directory -->
    <script src="scripts/firms-directory.js"></script>
    
    <!-- Master Interface Controller -->
    <script src="scripts/master-interface-controller.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🏢 Firms page initialized');
            if (window.MasterInterfaceController) {
                window.masterInterface = new MasterInterfaceController();
                window.masterInterface.activateTab('firms');
            }
            window.handleLogout = function() {
                if (window.authService && window.authService.logout) {
                    window.authService.logout();
                }
                window.location.href = 'cipher-begins.html';
            };
        });
    </script>
</body>
</html>